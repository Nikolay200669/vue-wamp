/*!
 * vue-wamp v2.0.0
 * https://github.com/lajosbencz/vue-wamp#readme
 * Released under the MIT License.
 */import a from"autobahn";function b(a,b){return b={exports:{}},a(b,b.exports),b.exports}var c=b(function(a){var b=a.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=b)}),d=b(function(a){var b=a.exports={version:"2.6.3"};"number"==typeof __e&&(__e=b)}),e=d.version,g=function(a){return"object"==typeof a?null!==a:"function"==typeof a},h=function(a){if(!g(a))throw TypeError(a+" is not an object!");return a},i=function(a){try{return!!a()}catch(a){return!0}},j=!i(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),k=c.document,l=g(k)&&g(k.createElement),m=function(a){return l?k.createElement(a):{}},n=!j&&!i(function(){return 7!=Object.defineProperty(m("div"),"a",{get:function(){return 7}}).a}),o=function(a,b){if(!g(a))return a;var c,d;if(b&&"function"==typeof(c=a.toString)&&!g(d=c.call(a)))return d;if("function"==typeof(c=a.valueOf)&&!g(d=c.call(a)))return d;if(!b&&"function"==typeof(c=a.toString)&&!g(d=c.call(a)))return d;throw TypeError("Can't convert object to primitive value")},p=Object.defineProperty,q=j?Object.defineProperty:function(a,b,c){if(h(a),b=o(b,!0),h(c),n)try{return p(a,b,c)}catch(a){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");return"value"in c&&(a[b]=c.value),a},f={f:q},r=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}},s=j?function(a,b,c){return f.f(a,b,r(1,c))}:function(a,b,c){return a[b]=c,a},t={}.hasOwnProperty,u=function(a,b){return t.call(a,b)},v=0,w=Math.random(),x=function(a){return"Symbol(".concat(a===void 0?"":a,")_",(++v+w).toString(36))},y=b(function(a){var b=x("src"),e="toString",f=Function[e],g=(""+f).split(e);d.inspectSource=function(a){return f.call(a)},(a.exports=function(a,d,e,f){var h="function"==typeof e;h&&(u(e,"name")||s(e,"name",d));a[d]===e||(h&&(u(e,b)||s(e,b,a[d]?""+a[d]:g.join(d+""))),a===c?a[d]=e:f?a[d]?a[d]=e:s(a,d,e):(delete a[d],s(a,d,e)))})(Function.prototype,e,function(){return"function"==typeof this&&this[b]||f.call(this)})}),z=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a},A=function(d,e,f){return(z(d),void 0===e)?d:1===f?function(b){return d.call(e,b)}:2===f?function(c,a){return d.call(e,c,a)}:3===f?function(f,a,b){return d.call(e,f,a,b)}:function(){return d.apply(e,arguments)}},B="prototype",C=function(a,b,e){var f,g,h,i,j=a&C.F,k=a&C.G,l=a&C.S,m=a&C.P,n=a&C.B,o=k?c:l?c[b]||(c[b]={}):(c[b]||{})[B],p=k?d:d[b]||(d[b]={}),q=p[B]||(p[B]={});for(f in k&&(e=b),e)g=!j&&o&&void 0!==o[f],h=(g?o:e)[f],i=n&&g?A(h,c):m&&"function"==typeof h?A(Function.call,h):h,o&&y(o,f,h,a&C.U),p[f]!=h&&s(p,f,i),m&&q[f]!=h&&(q[f]=h)};c.core=d,C.F=1,C.G=2,C.S=4,C.P=8,C.B=16,C.W=32,C.U=64,C.R=128;var D=C,E={}.toString,F=function(a){return E.call(a).slice(8,-1)},G=Object("z").propertyIsEnumerable(0)?Object:function(a){return"String"==F(a)?a.split(""):Object(a)},H=function(a){if(a==null)throw TypeError("Can't call method on  "+a);return a},I=function(a){return G(H(a))},J=Math.ceil,K=Math.floor,L=function(a){return isNaN(a=+a)?0:(0<a?K:J)(a)},M=Math.min,N=function(a){return 0<a?M(L(a),9007199254740991):0},O=Math.max,P=Math.min,Q=function(a,b){return a=L(a),0>a?O(a+b,0):P(a,b)},R=function(a){return function(b,c,d){var e,f=I(b),g=N(f.length),h=Q(d,g);if(a&&c!=c){for(;g>h;)if(e=f[h++],e!=e)return!0;}else for(;g>h;h++)if((a||h in f)&&f[h]===c)return a||h||0;return!a&&-1}},S=!1,T=b(function(a){var b=c["__core-js_shared__"]||(c["__core-js_shared__"]={});(a.exports=function(a,c){return b[a]||(b[a]=c===void 0?{}:c)})("versions",[]).push({version:d.version,mode:S?"pure":"global",copyright:"\xA9 2019 Denis Pushkarev (zloirock.ru)"})}),U=T("keys"),V=function(a){return U[a]||(U[a]=x(a))},W=R(!1),X=V("IE_PROTO"),Y=function(a,b){var c,d=I(a),e=0,f=[];for(c in d)c!=X&&u(d,c)&&f.push(c);for(;b.length>e;)u(d,c=b[e++])&&(~W(f,c)||f.push(c));return f},Z=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],$=Object.keys||function(a){return Y(a,Z)},_=Object.getOwnPropertySymbols,aa={f:_},ba={}.propertyIsEnumerable,ca={f:ba},da=function(a){return Object(H(a))},ea=Object.assign,fa=!ea||i(function(){var a={},b={},c=Symbol(),d="abcdefghijklmnopqrst";return a[c]=7,d.split("").forEach(function(a){b[a]=a}),7!=ea({},a)[c]||Object.keys(ea({},b)).join("")!=d})?function(a){for(var b=da(a),c=arguments.length,d=1,e=aa.f,f=ca.f;c>d;)for(var g,h=G(arguments[d++]),i=e?$(h).concat(e(h)):$(h),k=i.length,l=0;k>l;)f.call(h,g=i[l++])&&(b[g]=h[g]);return b}:ea;D(D.S+D.F,"Object",{assign:fa});var ga=f.f,ha=Function.prototype,ia=/^\s*function ([^ (]*)/,ja="name";ja in ha||j&&ga(ha,ja,{configurable:!0,get:function(){try{return(""+this).match(ia)[1]}catch(a){return""}}});function ka(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function la(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function ma(a,b,c){return b&&la(a.prototype,b),c&&la(a,c),a}function na(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&pa(a,b)}function oa(a){return oa=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},oa(a)}function pa(a,b){return pa=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},pa(a,b)}function qa(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function ra(a,b){return b&&("object"==typeof b||"function"==typeof b)?b:qa(a)}function sa(a,b){for(;!Object.prototype.hasOwnProperty.call(a,b)&&(a=oa(a),null!==a););return a}function ta(a,b,c){return ta="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(a,b,c){var d=sa(a,b);if(d){var e=Object.getOwnPropertyDescriptor(d,b);return e.get?e.get.call(c):e.value}},ta(a,b,c||a)}var ua="vue-wamp",va="2.0.0",wa="WAMP protocol wrapper library for Vue",xa="dist/vue-wamp.cjs.js",ya="dist/vue-wamp.esm.js",za="dist/vue-wamp.js",Aa="dist/vue-wamp.min.js",Ba={build:"node build/build.js","example:router":"cd example/router && crossbar start","example:server":"node example/server.js",test:"echo \"Error: no test specified\" && exit 1"},Ca={type:"git",url:"git+https://github.com/lajosbencz/vue-wamp"},Da=["vue","wamp","autobahn","websocket"],Ea="Lajos Bencz <lazos@lazos.me>",Fa="MIT",Ga={url:"https://github.com/lajosbencz/vue-wamp/issues"},Ha="https://github.com/lajosbencz/vue-wamp#readme",Ia={autobahn:"^18.10.2"},Ja={"@babel/plugin-external-helpers":"^7.2.0","@babel/plugin-transform-parameters":"^7.2.0","@babel/preset-env":"^7.3.1",autobahn:"^18.10.2",rollup:"^1.1.2","rollup-plugin-babel":"^4.3.2","rollup-plugin-babel-minify":"^7.0.0","rollup-plugin-commonjs":"^9.2.0","rollup-plugin-json":"^3.1.0","rollup-plugin-node-resolve":"^4.0.0","rollup-plugin-replace":"^2.1.0"},Ka={"@babel/polyfill":"^7.2.5"},La={name:"vue-wamp",version:va,description:wa,private:!1,main:xa,module:ya,browser:za,jsdelivr:Aa,scripts:Ba,repository:Ca,keywords:Da,author:Ea,license:Fa,bugs:Ga,homepage:Ha,peerDependencies:Ia,devDependencies:Ja,dependencies:Ka},Ma=function(){function a(b){ka(this,a),this._con=b,this._reconnectors=[],this._subscriptions=[],this._registrations=[]}return ma(a,[{key:"subscribe",value:function(a,b,c){var d=this;c=c||{},c.acknowledge=!0,this._reconnectors.push(function(){d._con.subscribe(a,b,c).then(function(a){return d._subscriptions.push(a)}).catch(console.error)})}},{key:"register",value:function(a,b,c){var d=this;c=c||{},c.acknowledge=!0,this._reconnectors.push(function(){d._con.register(a,b,c).then(function(a){return d._registrations.push(a)}).catch(console.error)})}},{key:"clear",value:function(){this._reconnectors=[]}},{key:"reconnected",value:function(){for(var a in this._reconnectors){var b=this._reconnectors[a];b()}}},{key:"closed",value:function(){for(;0<this._subscriptions.length;){var a=this._subscriptions.shift();this._con.unsubscribe(a).catch(function(){})}for(;0<this._registrations.length;){var b=this._registrations.shift();this._con.unregister(b).catch(function(){})}}}]),a}(),Na=function(){function a(b,c,d){var e=this;ka(this,a),this._con=b,this._ctx=c,this._persist=new Ma(b,d),d.$on("reconnected",function(){e._persist.reconnected()}),d.$on("closed",function(){e.closed(),e._persist.closed()}),this._subscriptions=[],this._registrations=[]}return ma(a,[{key:"open",value:function(){return this._con.open()}},{key:"close",value:function(a,b){return this._con.close(a,b)}},{key:"call",value:function(a,b,c,d){return this._con.call(a,b,c,d)}},{key:"subscribe",value:function(a,b,c){var e=this;c=c||{},c.acknowledge=!0;var f=this._con.defer();return this._con.subscribe(a,b,c).then(function(a){e._subscriptions.push(a),f.resolve(a)},f.reject),this._persist.subscribe(a,b,c),f.promise}},{key:"register",value:function(a,b,c){var e=this;c=c||{},c.acknowledge=!0;var f=this._con.defer();return this._con.register(a,b,c).then(function(a){e._registrations.push(a),f.resolve(a)},f.reject),this._persist.register(a,b,c),f.promise}},{key:"publish",value:function(a,b,c,d){return this._con.publish(a,b,c,d)}},{key:"unsubscribe",value:function(a){return this._con.unsubscribe(a)}},{key:"unregister",value:function(a){return this._con.unregister(a)}},{key:"closed",value:function(){for(;0<this._subscriptions.length;){var a=this._subscriptions.shift();this._con.unsubscribe(a).catch(function(){})}for(;0<this._registrations.length;){var b=this._registrations.shift();this._con.unregister(b).catch(function(){})}}},{key:"destroy",value:function(){this.closed(),this._persist.closed(),this._persist.clear()}},{key:"isConnected",get:function(){return this._con.isConnected}},{key:"isOpen",get:function(){return this._con.isOpen}},{key:"isRetrying",get:function(){return this._con.isRetrying}}]),a}(),Oa="["+La.name+"]",Pa={log:function(){},info:function(){},warn:function(){},error:function(){}},Qa={log:function(){for(var b,c=arguments.length,d=Array(c),a=0;a<c;a++)d[a]=arguments[a];(b=console).log.apply(b,[Oa].concat(d))},info:function(){for(var b,c=arguments.length,d=Array(c),a=0;a<c;a++)d[a]=arguments[a];(b=console).info.apply(b,[Oa].concat(d))},warn:function(){for(var b,c=arguments.length,d=Array(c),a=0;a<c;a++)d[a]=arguments[a];(b=console).warn.apply(b,[Oa].concat(d))},error:function(){for(var b,c=arguments.length,d=Array(c),a=0;a<c;a++)d[a]=arguments[a];(b=console).error.apply(b,[Oa].concat(d))}},Ra={debug:!1},Sa=function(a){function b(a,c){var d;ka(this,b),a=Object.assign({},Ra,a),d=ra(this,oa(b).call(this,a)),d._vueWampEvents=c,d._vueWampCfg=a,d._vueWampQRes=[],d._vueWampQRej=[];var f={isConnected:!1,isOpen:!1,isRetrying:!1},g=function(a){var b={isConnected:d.isConnected,isOpen:d.isOpen,isRetrying:d.isRetrying},g={status:b,lastStatus:f,details:a};d.log.info("Status emit",g),c.$emit("status",g),b.isOpen&&!f.isOpen?(c.$emit("opened",g),!b.isRetrying&&f.isRetrying&&c.$emit("reconnected",g)):!b.isOpen&&f.isOpen&&c.$emit("closed",g),b.isRetrying&&!f.isRetrying&&c.$emit("retrying",g),f=b};return d.onopen=function(b,c){d.log.info("Connection opened",{session:b,details:c}),g(c);for(var e,f=d._vueWampQRes.length;0<d._vueWampQRes.length;)e=d._vueWampQRes.shift(),e(b);d.log.info("Sessions resolved:",f),d._vueWampQRej=[],a.hasOwnProperty("onopen")&&"function"==typeof a.onopen&&a.onopen(b,c)},d.onclose=function(b,c){d.log.info("Connection closed",{reason:b,details:c});var e=!1;c.will_retry||(d._autoreconnect_reset(),e=!0),g(c);for(var f,h=d._vueWampQRej.length;0<d._vueWampQRej.length;)f=d._vueWampQRej.shift(),f({reason:b,details:c});return d.log.info("Sessions rejected:",h),d._vueWampQRes=[],a.hasOwnProperty("onclose")&&"function"==typeof a.onclose&&a.onclose(session,c),e},d.log.info("Connection create",{Connection:qa(qa(d))}),g(null),d}return na(b,a),ma(b,[{key:"withContext",value:function(a){return new Na(this,a,this._vueWampEvents)}},{key:"open",value:function(){this.log.info("Connection open",{Connection:this}),ta(oa(b.prototype),"open",this).call(this)}},{key:"close",value:function(a,c){this.log.info("Connection close",{Connection:this,reason:a,message:c}),ta(oa(b.prototype),"close",this).call(this,a,c)}},{key:"call",value:function(a,b,c,e){b=b||[],c=c||{},e=e||{},this.log.info("CALL",{procedure:a,args:b,kwargs:c,options:e});var f=this.defer();return this.sessionPromise.then(function(d){return d.call(a,b,c,e).then(f.resolve,f.reject,f.notify)}).catch(f.reject),f.promise}},{key:"publish",value:function(a,b,c,e){b=b||[],c=c||{},e=e||{},e.acknowledge=!0,this.log.info("PUBLISH",{topic:a,args:b,kwargs:c,options:e});var f=this.defer();return this.sessionPromise.then(function(d){return d.publish(a,b,c,e).then(f.resolve,f.reject)}).catch(f.reject),f.promise}},{key:"register",value:function(a,b,c){c=c||{},c.acknowledge=!0,this.log.info("REGISTER",{procedure:a,endpoint:b,options:c});var e=this.defer();return this.sessionPromise.then(function(d){return d.register(a,b,c).then(e.resolve,e.reject)}).catch(e.reject),e.promise}},{key:"subscribe",value:function(a,b,c){c=c||{},this.log.info("SUBSCRIBE",{topic:a,handler:b,options:c});var e=this.defer();return this.sessionPromise.then(function(d){return d.subscribe(a,b,c).then(e.resolve,e.reject)}).catch(e.reject),e.promise}},{key:"unregister",value:function(a){this.log.info("UNREGISTER",a);var b=this.defer();return this.sessionPromise.then(function(c){return c.unregister(a).then(b.resolve,b.reject)}).catch(b.reject),b.promise}},{key:"unsubscribe",value:function(a){this.log.info("UNSUBSCRIBE",a);var b=this.defer();return this.sessionPromise.then(function(c){return c.unsubscribe(a).then(b.resolve,b.reject)}).catch(b.reject),b.promise}},{key:"version",get:function(){return La.version}},{key:"log",get:function(){return this._vueWampCfg.debug?Qa:Pa}},{key:"sessionPromise",get:function(){var a=this.defer();return this.isOpen&&this.session?a.resolve(this.session):(this.open(),this._vueWampQRes.push(a.resolve),this._vueWampQRej.push(a.reject)),a.promise}}]),b}(a.Connection),Ta=function(a,b){var c=new a,d=new Sa(b,c);a.Wamp=d,Object.defineProperties(a.prototype,{$wamp:{get:function(){return this._vueWampWithContext||(this._vueWampWithContext=d.withContext(this)),this._vueWampWithContext}}}),a.mixin({data:function(){return{wampIsConnected:!1,wampIsOpen:!1,wampIsRetrying:!1}},created:function(){var a=this;if(this===this.$root&&(c.$on("status",function(b){a.wampIsConnected=b.status.isConnected,a.wampIsOpen=b.status.isOpen,a.wampIsRetrying=b.status.isRetrying,a.$emit("$wamp.status",b)}),c.$on("opened",function(b){return a.$emit("$wamp.opened",b)}),c.$on("closed",function(b){return a.$emit("$wamp.closed",b)}),c.$on("retrying",function(b){return a.$emit("$wamp.retrying",b)}),c.$on("reconnected",function(b){return a.$emit("$wamp.reconnected",b)})),!!this.$options.wamp){var b=["subscribe","register"],e=this.$options.wamp,f=function(c){c=b[c];var f=e[c],h=function(b){if(!f.hasOwnProperty(b))return"continue";var e=f[b],g=void 0,h={acknowledge:!0};if("function"==typeof e?g=e:(g=e.handler,h=Object.assign(h,e),delete h.handler),"function"!=typeof e)throw"vue-wamp handler must be callable";a.$wamp[c](b,g.bind(a),h).then(function(a){return d.log.info("Component option: "+c+" "+b,a)}).catch(d.log.error)};for(var i in f){var j=h(i)}g=c};for(var g in b)f(g)}},beforeDestroy:function(){this.$wamp.destroy()}})};export default Ta;
//# sourceMappingURL=vue-wamp.esm.js.map
